---
title: "intRo: Data visualisation with R"
subtitle: "03 â€” Plot with ggplot2"
author: "Stefano Coretta"
# institute: "RStudio, PBC"
# date: "2016/12/12 (updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

background-image: url(https://upload.wikimedia.org/wikipedia/commons/b/be/Sharingan_triple.svg)

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
library(tidyverse)
theme_set(theme_minimal())
library(intRo)
data("social")
data("endangered")
data("harry_potter")
data("df_ratios")
df_ratios <- drop_na(df_ratios, student_ratio)
```

???

Image credit: [Wikimedia Commons](https://commons.wikimedia.org/wiki/File:Sharingan_triple.svg)

---

# Visualise data


---

# Graphic systems

- Base R.

- lattice.

- ggplot2 (the Grammar of Graphics).

---

# Base R plotting function

```{r}
x <- 1:10
y <- x^3

plot(x, y)
```

---

# Base R plotting function

```{r}
x <- seq(1, 10, by = 0.01)
y <- x^3

plot(x, y, type = "l", col = "purple", lwd = 3, lty = "dashed")
```

---

# Packages to the rescue

- The library.

- Packages contained in library.

- Base R (set of packages).

- Install extra packages with `install.packages("tidyverse")`.

---

# Packages to the rescue

To use a package installed in the library, you `attach` the package with `library()`.

---

# Packages to the rescue

```{r}
library(tidyverse)
```

---

# Do you sleep like a giraffe or a brown bat?

```{r}
ggplot(
  data = msleep,
  mapping = aes(x = sleep_total, y = sleep_rem)
) +
  geom_point()
```


---

# Do you sleep like a giraffe or a brown bat?


```{r}
ggplot(
  data = msleep,
  mapping = aes(x = sleep_total, y = sleep_rem, label = name)
) +
  geom_point() +
  geom_label()
```

---

# Social media users 2008-2019

```{r}
social %>%
  filter(platform %in% c("Facebook", "Twitter", "TikTok", "Instagram", "YouTube")) %>%
  ggplot(aes(year, users, colour = platform)) +
  geom_line() +
  geom_point()
```

---

# Language endangerment

```{r}
endangered %>%
  ggplot(aes(degree)) +
  geom_bar()
```

---

# Hogwarts houses

```{r}
harry_potter %>%
  ggplot(aes(house, fill = house)) +
  geom_bar()
```

---

# Student/teacher ratio

```{r}
world_avg <- df_ratios %>%
  summarize(avg = mean(student_ratio, na.rm = T)) %>%
  pull(avg)

df_ratios %>%
  mutate(region = fct_reorder(region, -student_ratio_region)) %>%
  ggplot(aes(x = region, y = student_ratio, color = region)) +
    geom_jitter(size = 2, alpha = 0.5, width = 0.2) +
    coord_flip() +
  labs(
    y = "Student to teacher ratio",
    x = element_blank()
  ) +
  theme(legend.position = "none")
```
